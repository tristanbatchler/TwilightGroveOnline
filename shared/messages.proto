syntax = "proto3";
package messages;
option go_package = "pkg/packets";

message Response {
    bool success = 1;
    oneof optional_msg {
        string msg = 2;
    }
}

message ClientId {
    uint64 id = 1;
}

message LoginRequest {
    string username = 1;
    string password = 2;
}

message LoginResponse {
    Response response = 1;
}

message RegisterRequest {
    string username = 1;
    string password = 2;
}

message RegisterResponse {
    Response response = 1;
}

message Logout { }

message Chat {
    string msg = 1;
}

message ActorInfo {
    uint64 id = 1;
    int32 x = 2;
    int32 y = 3;
    string name = 4;
}

message ActorMove {
    int32 dx = 2;
    int32 dy = 3;
}

message Motd {
    string msg = 1;
}

message Disconnect { }

message AdminLoginGranted { }

message SqlQuery {
    string query = 1;
}

message SqlRow {
    repeated string values = 1;
}

message SqlResponse {
    Response response = 1;
    repeated string columns = 2;
    repeated SqlRow rows = 3;
}

message LevelUpload {
    bytes data = 1;
}

message LevelUploadResponse {
    Response response = 1;
}

message Packet {
    uint64 sender_id = 1;
    oneof msg {
        ClientId client_id = 2;
        LoginRequest login_request = 3;
        LoginResponse login_response = 4;
        RegisterRequest register_request = 5;
        RegisterResponse register_response = 6;
        Logout logout = 7;
        Chat chat = 8;
        ActorInfo actor_info = 9;
        ActorMove actor_move = 10;
        Motd motd = 11;
        Disconnect disconnect = 12;
        AdminLoginGranted admin_login_granted = 13;
        SqlQuery sql_query = 14;
        SqlResponse sql_response = 15;
        LevelUpload level_upload = 16;
        LevelUploadResponse level_upload_response = 17;
    }
}